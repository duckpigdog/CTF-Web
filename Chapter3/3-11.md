### 自定义 Code 验证爆破

话不多说，直接上题（青少年 CTF 练习平台）

![](https://pic1.imgdb.cn/item/6839e72258cb8da5c81e632f.png)

打开页面

![](https://pic1.imgdb.cn/item/6839e73358cb8da5c81e6335.png)

扫描目录有个 `/admin`，访问限制为本地用户

![](https://pic1.imgdb.cn/item/6839e76158cb8da5c81e633c.png)

添加 XFF 头绕过

```
X-Forwarded-For: 127.0.0.1
```

![](https://pic1.imgdb.cn/item/6839e79558cb8da5c81e633e.png)

点击 Get Flag 又显示同样的要求

![](https://pic1.imgdb.cn/item/6839e7cc58cb8da5c81e6355.png)

伪造后发现报错

```
X-Forwarded-For: 127.0.0.1
```

![](https://pic1.imgdb.cn/item/6839e84058cb8da5c81e6364.png)

查看源代码发现对 `X-Internal-Auth` 字段有验证

根据提示 `Incorrect code` 猜测不是 000

![](https://pic1.imgdb.cn/item/6839e87658cb8da5c81e636d.png)

对数字爆破拿到 flag

![](https://pic1.imgdb.cn/item/6839e90258cb8da5c81e6388.png)