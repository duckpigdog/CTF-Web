### .svn 文件泄露

话不多说，直接上题（CTFHUB）

![](https://pic1.imgdb.cn/item/6878ce9d58cb8da5c8bec1a7.png)

扫描发现有 `.svn/` 目录，确认是  `.svn`  泄露

使用 `dvcs-ripper` 工具中的 `rip-svn.pl` 脚本进行 clone

```perl
perl rip-svn.pl -u http://challenge-f54504e10cb99eb1.sandbox.ctfhub.com:10800/.svn/
```

![](https://pic1.imgdb.cn/item/6878cf9558cb8da5c8bec2bb.png)

1️⃣ **`entries`**

> **仅在旧版本 SVN（1.6 及以前）有用，新版废弃**

- **作用**：旧版 SVN 的目录、文件、状态信息记录（版本号 / 修改 / 是否忽略 / 路径关系等）
- **内容**：伪 XML 格式或纯文本
- **历史遗留**，现代 1.7+ 使用 `wc.db` 替代

```
plaintext复制编辑dir
9
https://svn.example.com/repo
...
```

------

2️⃣ **`format`**

> **作用**：标识当前 `.svn` 目录的元数据版本

| 数字 | 意义            | 对应版本 |
| ---- | --------------- | -------- |
| 8    | SQLite（wc.db） | 1.7      |
| 12   |                 | 1.8      |
| 29   |                 | 1.9      |
| ...  |                 | ...      |



举例内容：

```
12
```

> 表示该工作副本是 SVN 1.8 版本格式

------

3️⃣ **`pristine/`**

> **核心：文件内容仓库**

- 保存了**所有干净版本的源文件（未修改的原始版本）**
- 文件名是通过 `SHA1 哈希` 重命名后的，防止冲突、利于查找

```
.svn/pristine/ab/cd/abcdef1234567890.svn-base
```

- **作用**：用于对比工作区是否改动
- **本质**：存储的是**未被编辑的原始版本**，类似 Git 的 `objects/`

------

4️⃣ **`text-base/`**

> **1.6 以前旧结构**，现代 SVN 不再使用。

- 保存清理缓存的基线内容， `.svn-base` 后缀
- 每个工作区文件对比改动时用
- 与 `pristine/` 相似，但这是**旧版设计**

------

5️⃣ **`tmp/`**

> **临时文件目录**

- 执行 checkout / update / revert 时产生临时数据
- 类似于 `.git/objects/tmp`
- 意外中断操作后可安全删除

------

6️⃣ **`wc.db`**

> **SQLite 数据库，现代 SVN 的核心**

- **作用**：记录所有元数据信息
- **类型**：标准 SQLite 数据库
- **包含内容**：
  - 仓库信息（URL / UUID / 根路径）
  - 各文件状态（版本 / 是否修改 / lock 信息）
  - 各目录与版本号映射
  - 目录树层级关系
  - pristine 哈希索引

可以用 `sqlite3 wc.db .tables` 查看表：

| 表          | 含义                         |
| ----------- | ---------------------------- |
| NODES       | 各个节点（目录、文件）状态   |
| ACTUAL_NODE | 工作区实际状态（冲突、属性） |
| REPOSITORY  | 仓库信息                     |
| PRISTINE    | 哈希表映射至 pristine 目录   |
| LOCK        | 锁信息                       |
| WC_LOCK     | 工作目录锁                   |



👉 **核心：工作副本的实际状态都在这里！**

------

7️⃣ **`wc.db-journal`**

> SQLite 数据库的 **事务日志**

- 突然断电、进程崩溃，未提交事务保留在这里
- **正常关闭后自动消失**，此处为临时遗留无影响
- 如果一直存在可能表示该工作区未正常关闭

![](https://pic1.imgdb.cn/item/6878cfb258cb8da5c8bec2d7.png)

找到 flag

![](https://pic1.imgdb.cn/item/6878cff758cb8da5c8bec2f6.png)

